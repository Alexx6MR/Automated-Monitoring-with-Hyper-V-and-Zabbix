---
# 1. Configuraci칩n de Idioma y Teclado (Suecia)
- name: Install Swedish language pack
  ansible.builtin.package:
    name: glibc-langpack-sv
    state: present

- name: Ensure sv_SE.UTF-8 locale is generated
  ansible.builtin.command: localedef -c -i sv_SE -f UTF-8 sv_SE.UTF-8
  register: locale_gen
  changed_when: "locale_gen.rc == 0"
  failed_when: false

- name: Set system locale to Swedish
  ansible.builtin.command: localectl set-locale LANG=sv_SE.UTF-8

- name: Set keyboard layout to SE (Sweden)
  ansible.builtin.command: localectl set-x11-keymap se

# 2. Actualizaci칩n y Herramientas B치sicas
- name: Install base administration tools
  ansible.builtin.package:
    name:
      - vim
      - wget
      - curl
      - net-tools
      - git
      - firewalld
      - python3-firewall
    state: present

# 3. Seguridad: Firewall
- name: Ensure firewalld is running
  ansible.builtin.systemd:
    name: firewalld
    state: started
    enabled: true

- name: Allow SSH in firewall
  ansible.posix.firewalld:
    service: ssh
    permanent: true
    state: enabled
    immediate: true

- name: Enable HTTP and HTTPS services in firewalld
  ansible.posix.firewalld:
    service: "{{ item }}"
    permanent: true
    state: enabled
    immediate: true
  loop:
    - http
    - https

- name: Enable MySQL service in firewalld
  ansible.posix.firewalld:
    service: mysql
    permanent: true
    state: enabled
    immediate: true

# 5. Configuraci칩n de /etc/hosts (Para que localhost siempre funcione)
- name: Ensure localhost is mapped correctly
  ansible.builtin.lineinfile:
    path: /etc/hosts
    line: "127.0.0.1 localhost localhost.localdomain"
    state: present